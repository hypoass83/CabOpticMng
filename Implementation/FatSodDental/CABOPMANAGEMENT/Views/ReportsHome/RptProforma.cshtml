@using FatSod.Ressources;

@model FatSod.Report.WrapReports.RptProformaInvoice
@{
    Layout = "~/Views/Shared/_Layout.cshtml";

}

<section class="invoice" style="font-size:1.05em">
    <!-- title row -->
    <div class="row" style="height:115px;">
        
    </div>
    <!-- info row -->
    <div class="row">
        <div class="col-xs-12 invoice-title" style="text-align:center">
            <h3> @Model.Title </h3>
            <h4> @Model.TitleFr </h4>
        </div>
    </div>
    <br />
    <div class="row invoice-info">
        <div class="col-xs-7">
            Name of the insured / Nom de l'assuré : <strong><b>@Model.InsurreName</b></strong><br />
            Patient Name / Nom du Patient : <strong><b>@Model.CustomerName</b></strong><br />
            Phone Number / Télephone : <strong><b>@Model.CustomerPhone</b></strong><br />
            Company / Entreprise : <strong><b>@Model.CustomerCompany</b></strong><br />
            Doctor / Medecin : <strong><b>@Model.CustomerDoctor</b></strong><br />
        </div>
        <div class="col-xs-5" style="text-align: right;margin-top: -20px;">
            <div class="row" style="margin-right: 1px;">
                <h3> Agence de </h3>
                <h4 style="margin-right:20px;"> @Model.Agency </h4> 
            </div>
            <div class="row" style="margin-right: 1px;">
                <strong><b>Refence:@Model.Reference</b></strong><br />
                <strong><b>Date : @Model.ProformaDate.ToString("dd/MM/yyyy")</b></strong><br />
            </div>
            @*<br />
        <br />*@
            @*<strong><b>Refence:@Model.Reference</b></strong><br />
        <strong><b>Date : @Model.ProformaDate.ToString("dd/MM/yyyy")</b></strong><br />*@
        </div>
        </div>
    <br />
    <!-- /.row -->
    <!-- Table row -->
    <div class="row">
        <div class="col-xs-12 table-responsive">
            <table class="table table-striped" border="1">
                <thead style="text-align:center;">
                    <tr style="border:1px solid;">
                        <th style="border:1px solid;text-align:center;padding:3px;">Designation</th>
                        <th style="border:1px solid;text-align:center;padding:3px;">Diopter/Dioptrie</th>
                        <th style="border:1px solid;text-align:center;padding:3px;">Unit Price/Prix Unitaire</th>
                        <th style="border:1px solid;text-align:center;padding:3px;">Total</th>
                    </tr>
                </thead>

                <tbody style="border:1px solid">
                   
                    @foreach (var item in Model.DetailLenses)
                    {
                        <tr style="border:1px dashed;">
                            <td style="text-align:left;padding-left:20px;padding-bottom:0px;width:5%;border-right:1px solid;">
                                @item.LensDesignation
                            </td>
                            @if (item.DetailLensID == 1)
                            {
                                <td style="text-align:center;padding-left:20px;padding-bottom:5px;width:35%;word-spacing:5px;">
                                    <span><b>@item.LensName</b></span>
                                </td>
                            }
                            else if (item.DetailLensID == 2)
                            {
                                <td style="text-align:left;padding-top:0px;padding-bottom:0px;padding-left:100px;width:35%;word-spacing:25px;">
                                    <span><b>@item.LensName</b></span>
                                </td>
                            }
                            else
                            {
                                <td style="text-align:left;padding-top:0px;padding-bottom:0px;padding-left:100px;width:35%;word-spacing:22px;">
                                    @item.LensName
                                </td>
                            }
                            <td style="text-align:left;padding-top:0px;padding-bottom:0px;padding-left:40px;width:15%;border-left:1px solid;">
                                @item.LensUnitPrice
                            </td>
                            @if (item.DetailLensID == 3)
                            {
                                <td style="text-align:left;padding-top:0px;padding-bottom:0px;padding-left:40px;width:15%;border-left:1px solid;">
                                    @Model.TotalLens.ToString("N0")
                                </td>
                            }
                            else
                            {
                                <td style="text-align:left;padding-top:0px;padding-bottom:0px;padding-left:40px;width:15%;border-left:1px solid;"></td>
                            }
                            @*<td style="text-align:left;padding-top:0px;padding-left:40px;width:15%;border-left:1px solid;">
                                @item.LensAmount
                            </td>*@
                        </tr>
                    }
                    @*<tr style="border:1px solid;">
                        <td style="border:1px solid;text-align:center;padding:3px;"></td>
                        <td style="border:1px solid;text-align:center;padding:3px;"><span><b>Total Lens / Total verre</b></span></td>
                        <td style="border:1px solid;text-align:center;padding:3px;"></td>
                        <td style="border:1px solid;text-align:left;padding-left:40px;"><span><b>@Model.TotalLens</b></span></td>
                    </tr>*@
                    @if (Model.DetailFrames.Count > 0)
                    {
                        <tr style="border:1px solid;">
                            <td style="text-align:left;padding-left:20px;padding-bottom:0px;width:5%;border-top:1px solid;border-bottom:1px solid;">@Model.DetailFrames.FirstOrDefault().FrameQuantity</td>
                            <td style="text-align:center;padding:3px;border-bottom:1px solid;border-top:1px solid;border-left:1px solid;"><span><b>Frame(s) / Monture(s)</b></span></td>
                            <td style="text-align:center;padding:3px;border-bottom:1px solid;border-top:1px solid;"></td>
                            <td style="text-align:left;padding-left:40px;border-bottom:1px solid;border-top:1px solid;"></td>
                        </tr>
                    }
                    
                    @foreach (var item in Model.DetailFrames)
                    {
                        <tr style="border:1px dashed;">
                            <td style="text-align:left;padding-top:0px;padding-bottom:0px;padding-left:20px;width:5%;border-right:1px solid;">
                                
                            </td>
                            <td style="text-align:left;padding-top:0px;padding-bottom:0px;padding-left:100px;width:45%;">
                                @item.FrameName
                            </td>
                            <td style="text-align:left;padding-top:0px;padding-bottom:0px;padding-left:40px;width:15%;border-left:1px solid;">
                                @item.FrameUnitPrice
                            </td>
                            <td style="text-align:left;padding-top:0px;padding-bottom:0px;padding-left:40px;width:15%;border-left:1px solid;">
                                @item.FrameAmount
                            </td>
                        </tr>
                    }
                    <tr style="border:1px solid;">
                        <td style="border:1px solid;text-align:center;padding:3px;"></td>
                        <td style="border-bottom:1px solid;border-top:1px solid;text-align:center;padding:3px;"><span><b>Grand Total</b></span></td>
                        <td style="border-bottom:1px solid;border-top:1px solid;text-align:center;padding:3px;"></td>
                        <td style="border-bottom:1px solid;border-top:1px solid;text-align:left;padding-left:40px;"><span><b>@Model.TotalAmount.ToString("N0")</b></span></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- /.col -->
    </div>
    <br />
    <div class="row invoice-info">
        <div class="col-xs-12">
            End this bill with the Sum of : <strong><b>@Model.MontantLettreEn FCFA</b></strong><br /><br />
            Arrete cette Facture proforma à la somme de : <strong><b>@Model.MontantLettreFr FCFA</b></strong><br /><br />
        </div>

    </div>
    <div class="row invoice-info">
        <br />
        <div class="col-md-12" style="text-align:right;margin-right:100px;">
            <span style="font-size:1.2em;"><b>OPERATOR / OPERATEUR</b></span><br />
            <span style="font-size:0.8em;"><b>@Model.Operator</b></span>
        </div>
    </div>

    <!-- /.row -->
    <!-- this row will not appear when printing -->
    <div class="row no-print">
        <div class="col-xs-12">
            <a href="#" onclick="window.focus(); window.print(); window.close();" target="_blank" class="btn btn-primary"><i class="fa fa-print"></i> Imprimer</a>
            <a href="@Request.UrlReferrer" class="btn btn-warning"><i class="fa fa-angle-left"></i>@Resources.previous</a>
        </div>
    </div>
</section>


<style>
    .invoice {
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    }
</style>






